{"ast":null,"code":"var _s = $RefreshSig$();\n// api\nimport api from \"../utils/api\";\nimport { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport useFlashMessage from \"./useFlashMessage\";\nexport default function useAuth() {\n  _s();\n  const [authenticated, setAuthenticated] = useState(false);\n  const {\n    setFlashMessage\n  } = useFlashMessage();\n  const navigate = useNavigate();\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      // localStorage.clear();\n      api.defaults.headers.Authorization = `Bearer ${JSON.parse(token)}`;\n      setAuthenticated(true);\n    }\n  }, []);\n  async function register(user) {\n    let msgText = \"Registration completed successfully!\";\n    let msgType = \"success\";\n    try {\n      const data = await api.post(\"users/register\", user).then(response => {\n        return response.data;\n      });\n      await authUser(data);\n    } catch (error) {\n      msgText = error.response.data.message;\n      msgType = \"error\";\n    }\n    setFlashMessage(msgText, msgType);\n  }\n  function logout() {\n    const msgText = \"Log Out Successful\";\n    const msgType = \"success\";\n    setAuthenticated(false);\n    localStorage.removeItem(\"token\");\n    api.defaults.headers.Authorization = undefined;\n    navigate(\"/\");\n    setFlashMessage(msgText, msgType);\n  }\n  async function login(user) {\n    let msgText = \"Log In successful\";\n    let msgType = \"success\";\n    try {\n      const data = await api.post(\"users/login\", user).then(response => {\n        return response.data;\n      });\n      await authUser(data);\n    } catch (error) {\n      msgText = error.response.data.message;\n      msgType = \"error\";\n    }\n    setFlashMessage(msgText, msgType);\n  }\n  async function forgotpassword(user) {\n    let msgText = \"instruction sent to email\";\n    let msgType = \"success\";\n    try {\n      await api.post(\"users/forgotpassword\", user).then(response => {\n        return response.data;\n      });\n    } catch (error) {\n      msgText = error.response.data.message;\n      msgType = \"error\";\n    }\n    setFlashMessage(msgText, msgType);\n  }\n  async function resetpassword(token) {\n    let msgText = \"Password Updated\";\n    let msgType = \"success\";\n    try {\n      await api.patch(`users/resetpassword/${token}`).then(response => {\n        return response.data;\n      });\n    } catch (error) {\n      msgText = error.response.data.message;\n      msgType = \"error\";\n    }\n    setFlashMessage(msgText, msgType);\n  }\n  async function authUser(data) {\n    setAuthenticated(true);\n    localStorage.setItem(\"token\", JSON.stringify(data.token));\n    navigate(\"/\");\n  }\n  return {\n    authenticated,\n    register,\n    logout,\n    login,\n    forgotpassword,\n    resetpassword\n  };\n}\n_s(useAuth, \"T4K9EEYXv4RHpmjs21Tdc4ErcUk=\", false, function () {\n  return [useFlashMessage, useNavigate];\n});","map":{"version":3,"names":["api","useState","useEffect","useNavigate","useFlashMessage","useAuth","_s","authenticated","setAuthenticated","setFlashMessage","navigate","token","localStorage","getItem","defaults","headers","Authorization","JSON","parse","register","user","msgText","msgType","data","post","then","response","authUser","error","message","logout","removeItem","undefined","login","forgotpassword","resetpassword","patch","setItem","stringify"],"sources":["C:/Users/Fabiano/Desktop/to_do_app/frontend/src/hooks/useAuth.js"],"sourcesContent":["// api\r\nimport api from \"../utils/api\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport useFlashMessage from \"./useFlashMessage\";\r\n\r\nexport default function useAuth() {\r\n  const [authenticated, setAuthenticated] = useState(false);\r\n  const { setFlashMessage } = useFlashMessage();\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n\r\n    if (token) {\r\n      // localStorage.clear();\r\n      api.defaults.headers.Authorization = `Bearer ${JSON.parse(token)}`;\r\n      setAuthenticated(true);\r\n    }\r\n  }, []);\r\n\r\n  async function register(user) {\r\n    let msgText = \"Registration completed successfully!\";\r\n    let msgType = \"success\";\r\n    try {\r\n      const data = await api.post(\"users/register\", user).then((response) => {\r\n        return response.data;\r\n      });\r\n      await authUser(data);\r\n    } catch (error) {\r\n      msgText = error.response.data.message;\r\n      msgType = \"error\";\r\n    }\r\n\r\n    setFlashMessage(msgText, msgType);\r\n  }\r\n\r\n  function logout() {\r\n    const msgText = \"Log Out Successful\";\r\n    const msgType = \"success\";\r\n\r\n    setAuthenticated(false);\r\n    localStorage.removeItem(\"token\");\r\n    api.defaults.headers.Authorization = undefined;\r\n    navigate(\"/\");\r\n\r\n    setFlashMessage(msgText, msgType);\r\n  }\r\n\r\n  async function login(user) {\r\n    let msgText = \"Log In successful\";\r\n    let msgType = \"success\";\r\n\r\n    try {\r\n      const data = await api.post(\"users/login\", user).then((response) => {\r\n        return response.data;\r\n      });\r\n\r\n      await authUser(data);\r\n    } catch (error) {\r\n      msgText = error.response.data.message;\r\n      msgType = \"error\";\r\n    }\r\n\r\n    setFlashMessage(msgText, msgType);\r\n  }\r\n\r\n  async function forgotpassword(user) {\r\n    let msgText = \"instruction sent to email\";\r\n    let msgType = \"success\";\r\n    try {\r\n      await api.post(\"users/forgotpassword\", user).then((response) => {\r\n        return response.data;\r\n      });\r\n    } catch (error) {\r\n      msgText = error.response.data.message;\r\n      msgType = \"error\";\r\n    }\r\n\r\n    setFlashMessage(msgText, msgType);\r\n  }\r\n\r\n  async function resetpassword(token) {\r\n    let msgText = \"Password Updated\";\r\n    let msgType = \"success\";\r\n\r\n    try {\r\n      await api.patch(`users/resetpassword/${token}`).then((response) => {\r\n        return response.data;\r\n      });\r\n    } catch (error) {\r\n      msgText = error.response.data.message;\r\n      msgType = \"error\";\r\n    }\r\n\r\n    setFlashMessage(msgText, msgType);\r\n  }\r\n\r\n  async function authUser(data) {\r\n    setAuthenticated(true);\r\n\r\n    localStorage.setItem(\"token\", JSON.stringify(data.token));\r\n    navigate(\"/\");\r\n  }\r\n\r\n  return {\r\n    authenticated,\r\n    register,\r\n    logout,\r\n    login,\r\n    forgotpassword,\r\n    resetpassword,\r\n  };\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}